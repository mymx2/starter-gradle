# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json
name: Close issue
run-name: Auto close inactive issues with schedule

on:
  schedule:
    - cron: "0 0 */7 * *"

jobs:
  close-issues:
    permissions:
      issues: write
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ˜ž check the labels and auto close it
        uses: actions-cool/issues-helper@9861779a695cf1898bd984c727f685f351cfc372 # v3.7.2
        with:
          actions: "close-issues"
          token: ${{ secrets.GITHUB_TOKEN }}
          labels: "status|waiting-reproduction,status|waiting-feedback"
          inactive-day: 7
          body: |
            Hi, this issue has been closed because it has been inactive for more than 7 days.
            If you think it should still be open, please reply here.
      - name: ðŸ§¹ replace labels
        uses: actions-cool/issues-helper@9861779a695cf1898bd984c727f685f351cfc372 # v3.7.2
        with:
          actions: "set-labels"
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ github.event.issue.number }}
          labels: "close|invalid"

  action-debug:
    if: failure() || vars.ACTION_DEBUG_WORKFLOW == github.workflow
    uses: ./.github/workflows/_debug.yml
    secrets: inherit
